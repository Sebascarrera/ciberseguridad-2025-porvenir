:root{
    --ok:#06d6a0;
    --bad:#ef476f;
    --ink:#ffffff;
    --panel: rgba(0,0,0,.65);
    --panel-2: rgba(0,0,0,.35);
    --stroke: rgba(255,255,255,.12);
    --glow: rgba(0,255,204,.5);
    --accent:#3a86ff;
  }
  
  /* ===== PLAY WRAP con imagen de fondo ===== */
  .cm-play-wrap{
    min-height:100dvh;
    color:var(--ink);
    display:flex;
    flex-direction:column;
  
    /* Fondo por capas: tu imagen + degradados de lectura */
    background:
      radial-gradient(60% 60% at 50% 10%, rgba(0, 255, 204, .12), rgba(0,0,0,0)),
      linear-gradient(180deg, rgba(11,15,20,.95), rgba(9,12,16,.70) 60%, rgba(7,10,12,.70)),
      var(--cm-bg-url, none);
    background-size: 100% 100%, 100% 100%, cover;
    background-position: center center, center center, center center;
    background-repeat: no-repeat, no-repeat, no-repeat;
  }
  
  /* ========= Confeti (overlay fijo) ========= */
  .cm-confetti{
    position: fixed !important;
    inset: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    pointer-events: none !important;
    z-index: 2147483000 !important;
    display: block !important;
  }
  
  /* ======= HUD ======= */
  .cm-hud{
    display:grid;
    grid-template-columns: 1fr 1.4fr 1fr;
    align-items:center;
    gap:10px;
    padding:18px clamp(12px, 4vw, 24px);
  }
  .cm-hud-left, .cm-hud-right{ display:flex; align-items:center; gap:12px; }
  .cm-hud-right{ justify-content:flex-end; }
  .cm-hud-center{
    display:flex; align-items:center; justify-content:center; gap:22px;
  }
  
  /* Botón volver */
  .cm-ghost-btn{
    background:transparent;
    border:1px solid var(--stroke);
    color:var(--ink);
    padding:8px 12px; border-radius:12px;
    transition: background .2s ease, transform .06s ease;
  }
  .cm-ghost-btn:hover{ background: rgba(255,255,255,.06); transform: translateY(-1px); }
  
  /* Logo Cipo con animación de entrada */
  .cm-brand{
    height: clamp(26px, 5.2vw, 46px);
    width: auto;
    display: block;
    filter: drop-shadow(0 4px 14px rgba(0,0,0,.45));
    user-select: none;
    animation: cm-brand-in .6s cubic-bezier(.22,1,.36,1) both;
  }
  @keyframes cm-brand-in{
    from{ opacity: 0; transform: translateY(-6px) scale(.98); }
    to  { opacity: 1; transform: translateY(0)    scale(1); }
  }
  
  /* ======= Timer & Score ======= */
  .cm-timer{ position:relative; width:64px; height:64px; }
  .cm-timer-svg{ width:64px; height:64px; transform:rotate(-90deg); }
  .cm-timer-bg{ fill:none; stroke:rgba(255,255,255,.18); stroke-width:6; }
  .cm-timer-fg{ fill:none; stroke:var(--accent); stroke-width:6; stroke-linecap:round; transition: stroke-dasharray .3s linear, stroke .2s ease; }
  .cm-timer-fg.urgent{ stroke: var(--bad); }
  .cm-timer-text{ position:absolute; inset:0; display:grid; place-items:center; font-weight:700; font-size:14px; }
  
  .cm-score{
    background:var(--panel);
    padding:10px 16px; border-radius:12px;
    display:flex; flex-direction:column; align-items:center;
    border:1px solid var(--stroke);
    min-width:90px;
  }
  .cm-score-label{ opacity:.8; font-size:12px; }
  .cm-score-value{ font-size:24px; font-weight:700; letter-spacing:.5px; }
  
  .cm-combo{ display:flex; flex-direction:column; align-items:center; gap:4px; }
  .cm-chip{
    border:1px solid var(--stroke);
    padding:6px 10px; border-radius:999px; background:var(--panel);
  }
  .cm-chip.glow{ box-shadow:0 0 18px var(--glow); }
  .cm-subchip{ font-size:12px; opacity:.8; }
  
  /* ======= Stage ======= */
  .cm-stage{
    flex:1; display:grid; place-items:center;
    padding: 12px clamp(12px, 4vw, 24px) 28px;
  }
  
  /* ======= Card ======= */
  .cm-card{
    width:min(900px, 95%);
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    border:1px solid var(--stroke);
    border-radius:18px;
    padding: clamp(16px, 3.2vw, 28px);
    box-shadow: 0 10px 42px rgba(0,0,0,.35);
    position:relative; overflow:hidden;
  }
  .cm-card.slide-left{ animation: cm-slide-left .22s ease both; }
  .cm-card.slide-right{ animation: cm-slide-right .22s ease both; }
  .cm-card.shake{ animation: cm-shake .35s ease both; }
  
  @keyframes cm-slide-left{ from{ transform:translateX(0) } to{ transform:translateX(-16px); opacity:.96 } }
  @keyframes cm-slide-right{ from{ transform:translateX(0) } to{ transform:translateX(16px); opacity:.96 } }
  @keyframes cm-shake{
    10%, 90% { transform: translateX(-2px) }
    20%, 80% { transform: translateX(4px) }
    30%, 50%, 70% { transform: translateX(-8px) }
    40%, 60% { transform: translateX(8px) }
  }
  
  /* ======= Card header (contraseña protagonista) ======= */
  .cm-card-top{
    display:flex; align-items:center; justify-content:center; gap:10px; /* centrado */
    width: 100%; text-align:center;
  }
  
  /* Reel (texto con tragamonedas) + halo */
  .cm-reel{
    position: relative; z-index: 0;
    display:flex; flex-wrap:wrap; gap:.02em; align-items:baseline; justify-content:center;
    font-size: clamp(28px, 6vw, 52px);
    line-height: 1.15;
    word-break: break-all;
    margin-inline: auto; text-align: center;
  
    /* Pop + brillo al aparecer cada contraseña */
    animation: cm-focus 0.85s cubic-bezier(.22,1,.36,1) both;
  }
  .cm-reel::after{
    content: "";
    position: absolute;
    left: 50%; top: 50%;
    transform: translate(-50%, -50%);
    width: clamp(200px, 45vw, 660px);
    height: clamp(60px, 12vw, 140px);
    background:
      radial-gradient(60% 65% at 50% 50%,
        rgba(0,255,204,.22) 0%,
        rgba(58,134,255,.18) 35%,
        rgba(0,0,0,0) 70%);
    filter: blur(22px);
    opacity: 0;
    pointer-events: none;
    z-index: 0;
    animation: cm-reel-glow 0.85s ease-out both;
  }
  .cm-reel-char{
    position: relative; z-index:1;
    display:inline-block; min-width: .6em; text-align:center;
    will-change: transform, filter, opacity;
    transition: filter .15s ease, transform .15s ease;
  }
  .cm-reel-char.spin{ filter: blur(.7px) brightness(1.05); transform: translateZ(0) rotateX(14deg); }
  .cm-reel-char.lock{ animation: cm-char-pop .18s ease; filter: none; transform: none; }
  
  @keyframes cm-focus{
    0%   { transform: scale(.98); filter: saturate(.9) brightness(.95); text-shadow: none; }
    50%  { transform: scale(1.01); filter: saturate(1.12) brightness(1.12);
           text-shadow: 0 0 10px rgba(124,201,255,.28), 0 0 18px rgba(0,255,204,.18); }
    100% { transform: scale(1); filter: none; text-shadow: none; }
  }
  @keyframes cm-reel-glow{
    0%   { opacity: 0; transform: translate(-50%,-50%) scale(.9); }
    50%  { opacity: 1; }
    100% { opacity: 0; transform: translate(-50%,-50%) scale(1.05); }
  }
  @keyframes cm-char-pop{ from{ transform: scale(.9); opacity:.7 } to{ transform: scale(1); opacity:1 } }
  
  /* Oculta la etiqueta de fuerza para no dar pistas */
  .cm-strength{ display: none !important; }
  
  /* ======= Barras y flags ======= */
  .cm-bars{ margin-top:16px; display:grid; gap:10px; grid-template-columns: 1fr; }
  .cm-bar-head{ display:flex; align-items:center; justify-content:space-between; font-size:14px; opacity:.9; }
  .cm-dot{ width:10px; height:10px; border-radius:50%; background: var(--bad); }
  .cm-dot.ok{ background: var(--ok); }
  .cm-bar-track{ position:relative; height:10px; background: rgba(255,255,255,.12); border-radius:999px; overflow:hidden; }
  .cm-bar-fill{
    position:absolute; inset:0 auto 0 0; transform-origin:left center; transform: scaleX(.2);
    background: linear-gradient(90deg, var(--accent), #7cc9ff);
    filter: drop-shadow(0 0 8px rgba(60,200,255,.35));
    transition: transform .35s cubic-bezier(.2,.7,0,1);
  }
  .cm-flags{ display:flex; gap:8px; flex-wrap:wrap; margin-top:6px; }
  .cm-flag{ font-size:12px; padding:5px 8px; border-radius:999px; border:1px solid var(--stroke); background:var(--panel-2); }
  .cm-flag.ok{ color:var(--ok); } .cm-flag.bad{ color:var(--bad); }
  
  /* ======= Acciones ======= */
  .cm-actions-row{ display:flex; gap:10px; justify-content:center; margin-top:18px; }
  .cm-btn{
    min-width:180px; padding:12px 14px; border-radius:12px; border:1px solid var(--stroke);
    background: var(--panel); color: var(--ink); font-weight:700; letter-spacing:.4px;
    transition: transform .06s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
  }
  .cm-btn:hover{ transform: translateY(-1px); box-shadow: 0 10px 24px rgba(0,0,0,.35); }
  .cm-btn:active{ transform: translateY(0); }
  .cm-btn-approve{
    background: linear-gradient(180deg, rgba(6,214,160,.22), rgba(6,214,160,.05));
    border-color: rgba(6,214,160,.35);
  }
  .cm-btn-reject{
    background: linear-gradient(180deg, rgba(239,71,111,.22), rgba(239,71,111,.05));
    border-color: rgba(239,71,111,.35);
  }
  
  /* Feedback stamp (puedes cambiar por PNG en background-image) */
  .cm-stamp{
    position:absolute; right:16px; top:16px; width:110px; height:110px; border-radius:50%;
    display:grid; place-items:center; font-weight:900; font-size:18px; letter-spacing:1px;
    backdrop-filter: blur(2px);
    animation: cm-pop .22s ease;
  }
  .cm-stamp.ok{
    color:var(--ok);
    border:3px dashed rgba(6,214,160,.75);
    box-shadow: 0 0 0 6px rgba(6,214,160,.12);
  }
  .cm-stamp.bad{
    color:var(--bad);
    border:3px dashed rgba(239,71,111,.75);
    box-shadow: 0 0 0 6px rgba(239,71,111,.12);
  }
  @keyframes cm-pop{ from{ transform:scale(.85); opacity:0 } to{ transform:scale(1); opacity:1 } }
  
  /* Hint */
  .cm-hint{ margin-top: 12px; text-align:center; opacity:.85; font-size:14px; }
  
  /* Strikes */
  .cm-strikes{ display:flex; gap:6px; justify-content:flex-end; }
  .cm-heart{ filter: drop-shadow(0 0 6px rgba(239,71,111,.35)); opacity:.35; }
  .cm-heart.hit{ opacity:1; transform: scale(1.08); }
  
  /* ======= Modal (fix móvil: no desborde) ======= */
  .cm-modal-wrap{
    position:fixed; inset:0; display:grid; place-items:center;
    background: rgba(0,0,0,.85);
    animation: cm-fade .2s ease;
    z-index: 40; /* por encima del footer */
    padding: 12px; /* margen interior en móviles para evitar cortes */
    box-sizing: border-box;
  }
  @keyframes cm-fade{ from{ opacity:0 } to{ opacity:1 } }
  
  .cm-modal{
    width: min(520px, 92vw);
    max-width: 92vw;
    max-height: calc(100dvh - 48px);
    overflow: auto;                 /* scroll interno si hace falta */
    overscroll-behavior: contain;
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    border:1px solid var(--stroke);
    border-radius:18px;
    padding: 24px;
    box-shadow:0 20px 48px rgba(0,0,0,.8);
    box-sizing: border-box;
    word-wrap: break-word;
    overflow-wrap: anywhere;
  }
  .cm-modal *{ min-width: 0; }     /* evita que hijos fuercen ancho */
  
  .cm-results{
    display:grid; grid-template-columns:1fr 1fr; gap:10px; margin:12px 0 18px;
  }
  @media (max-width: 420px){
    .cm-modal{ padding: 20px; }
    .cm-results{ grid-template-columns: 1fr; } /* 1 columna en móviles chicos */
  }
  
  .cm-modal-actions{ display:flex; gap:10px; justify-content:center; }
  .cm-save-hint{ font-size:12px; opacity:.8; text-align:center; margin-top:8px; }
  
  /* ======= Footer gráfico con parallax y variante móvil ======= */
  .cm-footer-wrap{
    position: fixed;
    left: 50%; bottom: 8px;
    transform: translate(-50%, 0); /* JS ajusta en desktop */
    z-index: 30;
    pointer-events: none;
    will-change: transform;
    filter: drop-shadow(0 8px 24px rgba(0,0,0,.45));
  }
  .cm-footer-img{
    width: min(980px, 92vw);
    height: auto;
    opacity: .96;
    display: block;
  }
  
  /* Responsive */
  @media (max-width: 720px){
    .cm-hud{ grid-template-columns: 1fr 1fr; grid-auto-rows:auto; }
    .cm-hud-center{ grid-column: 1 / -1; order:3; margin-top:6px; }
    .cm-hud-right{ justify-content:flex-end; }
    .cm-score-value{ font-size:20px; }
    .cm-actions-row .cm-btn{ min-width:140px; }
  }

  /* Ocultar footer en iPhone SE y pantallas muy cortas (retrato) */
@media screen and (orientation: portrait) and (max-width: 375px) and (max-height: 667px){
    .cm-footer-wrap{ display: none !important; }
  }
  
  /* Compat: iPhone SE (1ra gen) y alturas ultra cortas */
  @media screen and (orientation: portrait) and (max-width: 320px),
         screen and (max-height: 580px){
    .cm-footer-wrap{ display: none !important; }
  }

  /* Solo cuando el footer está visible (pantallas más grandes) */
@media screen and (min-height: 668px){
    .cm-stage{ padding-bottom: clamp(40px, 10vh, 140px); }
  }
  
  